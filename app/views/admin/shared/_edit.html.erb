<% http_method = (form_action[:action] == 'update') ? :put : :post %>

<%= form_tag(form_action, id: "#{form_type}_form", enctype: 'multipart/form-data', method: http_method) do %>
  <%= render :partial => "form" %>

  <div id="operations" class="tasks">
    <p class="r"><%= save(_("Save")) %> or <%= cancel %></p>
  </div>
<% end %>

<%=
  observe_form(
    "#{form_type}_form",
    frequency: 3,
    complete:  "$('preview').src = request.responseText; Element.show('preview');",
    url:       { action: 'preview' }
  )
%>
